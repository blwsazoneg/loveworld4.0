<!DOCTYPE html>
<html lang="en" x-data>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business with Espees</title>

    <!-- CRITICAL STYLESHEETS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/fonts.css">
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/business.css">
    <link rel="stylesheet" href="/css/modal.css">

    <!-- CRITICAL SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- KingsChat SDK Styles -->
    <link rel="stylesheet" href="https://unpkg.com/kingschat-web-sdk/dist/stylesheets/style.min.css" />

</head>

<body>

    <!-- Navbar Section -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" style="background-color: white;">
        <div class="container-fluid">
            <a class="navbar-brand text-gold" href="/">
                <!-- <img src="/images/logo.png" alt="Company Logo" height="30" class="d-inline-block align-text-top"> -->
                <b>LW 4.0</b>

            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link text-gold active" aria-current="page" href="/information.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-gold" href="/shop.html">Shop</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-gold" href="/explore.html">Explore</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-gold" href="/placements.html">Placements</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-gold" href="/innovate.html">Innovate</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-gold" href="/about.html">About</a>
                    </li>
                    <div class="d-flex align-items-center" x-data x-cloak>
                        <!-- Show these buttons if user is NOT logged in -->
                        <template x-if="!$store.auth.loggedIn">
                            <div class="d-flex">
                                <button class="btn btn-outline-gold me-2" data-bs-toggle="modal"
                                    data-bs-target="#signInUpModal" @click="$data.showRegisterForm = false">Sign
                                    In</button>

                                <a href="/signup.html" class="btn btn-gold">Sign Up</a>

                            </div>
                        </template>

                        <!-- Show this dropdown if user IS logged in -->
                        <template x-if="$store.auth.loggedIn">
                            <div class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle text-gold" role="button"
                                    data-bs-toggle="dropdown" aria-expanded="false"
                                    x-text="`Welcome, ${$store.auth.user.firstName}`"></a>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li><a class="dropdown-item" href="/profile.html">My Profile</a></li>
                                    <li x-show="$store.auth.hasRole('SBO')">
                                        <hr class="dropdown-divider">
                                    </li>

                                    <!-- Links for SBOs AND Admins -->
                                    <li x-show="$store.auth.hasRole('SBO')">
                                        <a class="dropdown-item" href="/admin-products.html">Manage Products</a>
                                    </li>
                                    <li x-show="$store.auth.hasRole('SBO')">
                                        <a class="dropdown-item" href="/manage-jobs.html">Manage Placements</a>
                                    </li>
                                    <li x-show="$store.auth.hasRole('SBO')">
                                        <a class="dropdown-item" href="/admin-orders.html">Manage Orders</a>
                                    </li>

                                    <!-- Link for Admins ONLY -->
                                    <li x-show="$store.auth.hasRole('Admin')">
                                        <a class="dropdown-item" href="/admin-dashboard.html">User Management</a>
                                    </li>
                                    <li x-show="$store.auth.hasRole('Admin')">
                                        <a class="dropdown-item" href="/admin-categories.html">Manage Categories</a>
                                    </li>
                                    <li x-show="$store.auth.hasRole('Admin')">
                                        <a class="dropdown-item" href="/admin-content.html">Manage Homepage</a>
                                    </li>
                                    <li x-show="$store.auth.hasRole('Admin')">
                                        <a class="dropdown-item" href="/admin-innovations.html">View Innovations</a>
                                    </li>
                                    <li x-show="$store.auth.hasRole('Admin')">
                                        <a class="dropdown-item" href="/admin-applications.html">Espees Businesses</a>
                                    </li>

                                    <li>
                                        <hr class="dropdown-divider">
                                    </li>
                                    <li><a class="dropdown-item" href="#"
                                            @click.prevent="$store.auth.logout()">Logout</a></li>
                                </ul>
                            </div>
                        </template>
                    </div>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Sign In/Up Modal (NEW DESIGN) -->
    <div class="modal fade" id="signInUpModal" tabindex="-1" aria-labelledby="signInUpModalLabel" aria-hidden="true"
        x-data="authModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Login Form View -->
                    <div x-show="!showRegisterForm" class="login-form-container">
                        <h2>Login to your account</h2>
                        <form @submit.prevent="handleLogin">
                            <input type="text" x-model="loginIdentifier" class="form-control"
                                placeholder="Email or Username" required>
                            <input type="password" x-model="loginPassword" class="form-control" placeholder="Password"
                                required>
                            <button type="submit" class="btn-login">Login</button>
                        </form>
                        <p class="create-account-link">
                            New here? <a href="#" @click.prevent="showRegisterForm = true">Create an account</a>
                        </p>
                        <button class="kc-web-sdk-btn" @click.prevent="loginWithKingsChat()"></button>

                        <div x-show="loginMessage" class="alert mt-3"
                            :class="loginError ? 'alert-danger' : 'alert-success'" x-text="loginMessage"></div>
                    </div>

                    <!-- Registration Form View -->
                    <div x-show="showRegisterForm" class="login-form-container"
                        style="color: #333; background: #fff; border-radius: 10px;">
                        <!-- We will re-style this form later to match the new theme -->
                        <!-- For now, we wrap it in a white box to keep it readable -->
                        <h2 style="color: #333;">Create Your Account</h2>
                        <form @submit.prevent="handleRegister">
                            <!-- Paste the full registration form fields here -->
                            <div class="row mb-2">
                                <div class="col"><input type="text" x-model="firstName" class="form-control"
                                        placeholder="First Name" required></div>
                                <div class="col"><input type="text" x-model="lastName" class="form-control"
                                        placeholder="Last Name" required></div>
                            </div>
                            <div class="mb-2"><input type="email" x-model="email" class="form-control"
                                    placeholder="Email" required></div>
                            <div class="mb-2"><input type="text" x-model="username" class="form-control"
                                    placeholder="Username" required></div>
                            <div class="mb-2"><input type="password" x-model="password" class="form-control"
                                    placeholder="Password" required></div>
                            <div class="mb-2"><input type="password" x-model="confirmPassword" class="form-control"
                                    placeholder="Confirm Password" required></div>

                            <button type="submit" class="btn-login">Register</button>
                        </form>
                        <p class="create-account-link" style="color: #666;">
                            Already have an account? <a href="#" @click.prevent="showRegisterForm = false"
                                style="color: #007bff;">Login here</a>
                        </p>
                        <div x-show="registerMessage" class="alert mt-3"
                            :class="registerError ? 'alert-danger' : 'alert-success'" x-text="registerMessage"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero-section business-hero text-white d-flex align-items-center justify-content-center text-center">
        <div class="hero-overlay"></div>
        <div class="container hero-content">
            <h1 class="display-4">Business with Espees</h1>
            <p class="lead my-4">Join our network of innovators and entrepreneurs.</p>
            <!-- <button class="btn btn-lg btn-gold" @click="$refs.contactForm.scrollIntoView({ behavior: 'smooth' })">Get
                Started</button> -->
        </div>
    </section>

    <!-- Section Two: Read More -->
    <section class="container my-5 py-5 text-center" x-data="{ showMore: false, showVendor: false }">
        <div class="row">
            <div class="col-lg-12 mx-auto mt-3 mb-2">
                <h2 class="fw-bold mb-4">Business is better with Espees</h2>
                <p class="lead text-muted">Conduct business transactions with Espees. </p>
                <button class="btn btn-outline-gold mt-4" @click="showMore = !showMore"><span
                        x-text="showMore ? 'Read Less' : 'Read More'"></span></button>
                <div x-show="showMore" x-collapse>
                    <div class="extra-content mt-2 text-center">
                        <p>Espees are proven stable and
                            reliable, with an upward value trajectory, making it far more dependable than other
                            currencies. Become an Espees business champion today and enjoy all the benefits that come
                            with it.</p>
                    </div>
                </div>

            </div>
            <div class="col-lg-12 mx-auto mt-5">
                <h2 class="fw-bold mb-4">Espees vendor locator</h2>
                <p class="lead text-muted"> Discover how Espees can help you save on your next shopping experience</p>
                <button class="btn btn-outline-gold mt-4" @click="showVendor = !showVendor"><span
                        x-text="showVendor ? 'Read Less' : 'Read More'"></span></button>
                <div x-show="showVendor" x-collapse>
                    <div class="extra-content mt-2 text-center">
                        <p>Find an Espees friendly business or vendor anywhere in the world with the espees vendor
                            locator.</p>
                            <p class="text-muted">Coming Soon</p>
                        <a href="#" class="btn btn-info btn-sm" disabled>Locate Espees Vendors</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section Three: Business Registration Form -->
    <section class="contact-form-section py-5" x-ref="contactForm" x-data="businessForm"> <!-- 1. Add x-data -->
        <div class="container">
            <div class="form-wrapper">
                <img src="/images/espees.png" alt="Business Logo" class="business-logo">
                <div class="form-container">
                    <p class="form-intro-text">Complete the details below to get started and become a benefits business.
                    </p>

                    <!-- 2. Add submit handler to the form -->
                    <form @submit.prevent="handleSubmit">
                        <!-- Row 1 -->
                        <div class="form-row">
                            <label for="businessRegNumber">Business Registration Number:</label>
                            <!-- 3. Add x-model to inputs -->
                            <input type="text" class="form-control" id="businessRegNumber" x-model="formData.regNumber">
                        </div>

                        <!-- Row 2 -->
                        <div class="form-row">
                            <label for="registeredName">Registered Business Name:</label>
                            <input type="text" class="form-control" id="registeredName" x-model="formData.name"
                                required>
                        </div>

                        <!-- Row 3 -->
                        <div class="form-row">
                            <label for="operatingLocation">Operating Location or HQ:</label>
                            <input type="text" class="form-control" id="operatingLocation" x-model="formData.location">
                        </div>

                        <!-- 4. Add a div for server messages -->
                        <div x-show="message" class="alert mt-4 text-center"
                            :class="error ? 'alert-danger' : 'alert-success'" x-text="message">
                        </div>

                        <div class="form-actions">
                            <!-- 5. Disable button while loading -->
                            <button type="submit" class="btn btn-gradient-gold px-5" :disabled="loading">
                                <span x-show="!loading">Submit</span>
                                <span x-show="loading">Submitting...</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- CRITICAL SCRIPTS AT THE END OF BODY -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- This creates window.kingsChatWebSdk -->
    <script src="/vendor/kingschat.bundle.js"></script>

    <!-- This uses window.kingsChatWebSdk -->
    <script src="/js/main.js" type="module"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

</body>

</html>